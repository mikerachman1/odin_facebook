<h1>Timeline</h1>

<% @posts.each do |post| %>
  <% user = User.find(post.user_id) %>
  <ul>
    <li><%= post.body %> - <%= link_to user.username, user_path(user) %></li>
    <%= post.created_at %><br>
    <%= post.likes.count %> - likes<br>
    <% like = post.find_like(current_user) %>
    <% if post.liked_by?(current_user) %>
      <%= link_to 'Un-like', post_like_path(post, like, like: { user_id: current_user.id, post_id: post.id }), data: { turbo_method: :delete } %>
    <% else %>
      <%= link_to 'Like', new_post_like_path(post, like: { user_id: current_user.id, post_id: post.id }) %>
    <% end %>
  </ul>
<% end %>

<h3>Add new post:</h3>
<%= render "post_form" %>